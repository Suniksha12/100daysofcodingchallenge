(()=>{"use strict";var e={112:function(e,n,i){var o=this&&this.__awaiter||function(e,n,i,o){return new(i||(i=Promise))((function(t,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}c((o=o.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.activate=void 0,i(87);const t=i(747),r=i(549),s=i(973),a=i(622);var c,d,u,l,m,p,f,v;let $;n.activate=function(e){$=new y,e.subscriptions.push(r.languages.registerCodeActionsProvider("python",$,{providedCodeActionKinds:[r.CodeActionKind.QuickFix]}));let n=r.commands.registerCommand("extension.pythonImagePreview",(()=>{$.createDirs(),r.window.showInformationMessage("Activate Python Image Preview")}));e.subscriptions.push(n)};class y{constructor(){this.createDirs()}createDirs(){var e,n=null===(e=r.window.activeTextEditor)||void 0===e?void 0:e.document.uri.fsPath.split(a.sep);null==n||n.pop();var i=null==n?void 0:n.join(a.sep);c=i+a.sep+"__pycache__"+a.sep+"preview",t.existsSync(c)&&t.rmdirSync(c,{recursive:!0}),d=this.MakeFolder(c,"OpenCV"),u=this.MakeFolder(c,"PIL"),l=this.MakeFolder(c,"Matplotlib"),m=this.MakeFolder(c,"ImageIO"),p=this.MakeFolder(c,"Tensorflow"),f=this.MakeFolder(c,"Pytorch"),v=this.MakeFolder(c,"Plotly"),c=c.replace(/[\\]/g,"/")}MakeFolder(e,n){var i=e+a.sep+n;return t.existsSync(i)||t.mkdirSync(i,{recursive:!0}),i.replace(/[\\]/g,"/")}provideCodeActions(e,n){return o(this,void 0,void 0,(function*(){const i=e.getWordRangeAtPosition(n.start),o=e.getText(i),t=r.debug.activeDebugSession;var a=!1;if(void 0!==i&&i.start.character>5){const n=new r.Range(i.start.line,i.start.character-5,i.end.line,i.start.character-1);"self"===e.getText(n)&&(a=!0)}if(void 0!==t){let e=yield t.customRequest("threads",{});for(const n of e.threads){var c=yield this.findfVariables(t,n.id,o,a);if(void 0!==c[0]){var $=c[0],y=c[1];const e=$.evaluateName,n=$.type;var h=[];if("ndarray"==n)yield Promise.all([s.OpenCV(e,t,y,d),s.Matplotlib(e,t,y,l)]).then((e=>{h=e}));else if(n.includes("Figure"))yield Promise.all([s.Figure(e,t,y,l),s.Plotly(e,t,y,v)]).then((e=>{h=e}));else if(n.includes("ImageFile")||"Image"==n){var g=yield s.PIL(e,t,y,u);h.push(g)}else if("Array"==n){var w=yield s.ImageIO(e,t,y,m);h.push(w)}else if("EagerTensor"==n){var x=yield s.Tensorflow(e,t,y,p);h.push(x)}else if("Tensor"==n){var _=yield s.Pytorch(e,t,y,f);h.push(_)}return h}}}}))}findfVariables(e,n,i,t){return o(this,void 0,void 0,(function*(){const o=(yield e.customRequest("stackTrace",{threadId:n})).stackFrames[0].id,r=(yield e.customRequest("scopes",{frameId:o})).scopes[0].variablesReference,s=yield e.customRequest("variables",{variablesReference:r});if(!0===t){const n=s.variables.find((e=>"self"===e.name));var a=(yield e.customRequest("variables",{variablesReference:n.variablesReference})).variables.find((e=>e.name===i))}else a=s.variables.find((e=>e.name===i));return[a,o]}))}}},973:function(e,n,i){var o=this&&this.__awaiter||function(e,n,i,o){return new(i||(i=Promise))((function(t,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var n;e.done?t(e.value):(n=e.value,n instanceof i?n:new i((function(e){e(n)}))).then(s,a)}c((o=o.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.Pytorch=n.Tensorflow=n.ImageIO=n.Plotly=n.Figure=n.Matplotlib=n.PIL=n.OpenCV=void 0;const t=i(549);n.OpenCV=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`_ = ${e} if ${e}.dtype == "uint8" else ${e} * 255`,s=`cv2.imwrite("${r}/${e}.png", _)`;if("[None, None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'import cv2',\n        '${o}',\n        '${s}']\n    ]`,frameId:i})).result){let n=`[OpenCV] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.PIL=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`${e}.save("${r}/${e}.png")`;if("[None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'from PIL import Image',\t\t\t\n        '${o}']\n    ]`,frameId:i})).result){let n=`[PIL] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.Matplotlib=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`plt.imsave("${r}/${e}.png", ${e})`;if("[None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'import matplotlib.pyplot as plt',\n        '${o}']\n    ]`,frameId:i})).result){let n=`[Matplotlib] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.Figure=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`${e}.savefig("${r}/${e}.png")`;if("[None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'import matplotlib.pyplot as plt',\n        '${o}']\n    ]`,frameId:i})).result){let n=`[Matplotlib] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.Plotly=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`${e}.write_image("${r}/${e}.png")`;if("[None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        '${o}']\n    ]`,frameId:i})).result){let n=`[Plotly] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.ImageIO=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`imageio.imwrite("${r}/${e}.png", ${e})`;if("[None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'import imageio',\n        '${o}']\n    ]`,frameId:i})).result){let n=`[ImageIO] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.Tensorflow=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`_ = Image.fromarray(${e}.numpy().astype("uint8"))`,s=`_.save("${r}/${e}.png")`;if("[None, None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'from PIL import Image',\n        '${o}',\n        '${s}']\n    ]`,frameId:i})).result){let n=`[Tensorflow] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}))},n.Pytorch=function(e,n,i,r){return o(this,void 0,void 0,(function*(){const o=`_ = ${e}.numpy().transpose(1, 2, 0) if ${e}.shape.index(min(${e}.shape)) == 0 else ${e}.numpy().transpose(2, 0, 1)`,s=`_.save("${r}/${e}.png")`;if("[None, None, None, None, None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n        'from PIL import Image',\n        'import numpy as np',\n        '${o}',\n        '_ = np.concatenate((_, _, _,), axis=-1) if _.shape[-1] == 1 else _',\n        '_ = Image.fromarray( (_ if _.dtype == "uint8" else _ * 255).astype("uint8"))',\n        '${s}']\n    ]`,frameId:i})).result){let n=`[Pytorch] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}{const o="from PIL import Image",s=`_ = ${e}.numpy() if ${e}.device == "cpu" else ${e}.cpu().numpy()`,a="_ = _.transpose(1, 2, 0) if len(_.shape) == 3 and _.shape.index(min(_.shape)) == 0 else _",c="_ = _.reshape(_.shape[:2]) if _.shape[-1] == 1 else _",d='_ = Image.fromarray( (_ if _.dtype == "uint8" else _ * 255).astype("uint8"))',u=`_.save("${r}/${e}.png")`;if("[None, None, None, None, None, None]"===(yield n.customRequest("evaluate",{expression:`[exec(code) for code in [\n            '${o}',\n            '${s}',\n            '${a}',\n            '${c}',\n            '${d}',\n            '${u}']\n        ]`,frameId:i})).result){let n=`[Pytorch] : ${e} Preview`;const i=new t.CodeAction(n,t.CodeActionKind.QuickFix);return i.command={command:"vscode.open",title:n,arguments:[t.Uri.file(`${r}/${e}.png`),t.ViewColumn.Beside]},i}}}))}},747:e=>{e.exports=require("fs")},87:e=>{e.exports=require("os")},622:e=>{e.exports=require("path")},549:e=>{e.exports=require("vscode")}},n={},i=function i(o){var t=n[o];if(void 0!==t)return t.exports;var r=n[o]={exports:{}};return e[o].call(r.exports,r,r.exports,i),r.exports}(112);module.exports=i})();